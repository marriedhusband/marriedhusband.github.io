!function(a){Drupal.janrainCapture={closeProfileEditor:function(){window.location.href=Drupal.settings.janrainCapture.profile_sync_url},closeRecoverPassword:function(){window.location.reload()},token_expired:function(){window.location.href=Drupal.settings.janrainCapture.token_expired_url},bp_ready:function(){var n=null,e=!1,r=Backplane.getChannelID();jQuery("script").each(function(){return jQuery(this).attr("src")&&(n=jQuery(this).attr("src"),void 0!=n&&n.search(/sso.js/i)>0)?(e=!0,!1):void 0}),e&&JANRAIN.SSO.CAPTURE.check_login({sso_server:"https://"+Drupal.settings.janrainCapture.sso_address,client_id:janrainCaptureClientId,redirect_uri:janrainCaptureRedirectUri,logout_uri:janrainCaptureLogoutUri,xd_receiver:janrainCaptureXdReceiver,bp_channel:r}),jQuery("a.janrain_capture_signin").each(function(){jQuery(this).attr("href",a(this).attr("href")+"&bp_channel="+r).click(function(){Backplane.expectMessages("identity/login")})})},logout:function(){"undefined"!=typeof Drupal.settings.janrainCapture.sso_address&&JANRAIN.SSO.CAPTURE.logout({sso_server:"https://"+Drupal.settings.janrainCapture.sso_address,logout_uri:Drupal.settings.janrainCapture.logout_url}),"undefined"!=typeof Backplane&&Backplane.resetCookieChannel()},addDestination:function(n){a.bbq&&a.bbq.pushState({destination:n})},removeDestination:function(){a.bbq&&a.bbq.removeState("destination")}},Drupal.janrainCapture.prototype={passwordRecover:function(a){},resize:function(a){}},Drupal.behaviors.janrainCapture={attach:function(n,e){if(e.janrainCapture.enforce){var r=Drupal.settings.janrainCapture.ver,t=Drupal.settings.basePath,i=a('a[href^="'+t+'user/login"], a[href^="'+t+'user/register"]').once("janrain-capture"),o=/(?:\?|&)destination\=([^\&]*)/;if("1.0"==r){var s=i.length;if(0!==i.length){var u,c;for(u=0;s>u;u++){c=i[u],a(c).addClass("janrain_capture_anchor janrain_capture_signin");var p=o.exec(a(c).attr("href"));if(p&&2==p.length){var l=p[1];a(c).data("destination",l)}}}"undefined"!=typeof e.janrainCapture.backplane_server&&"undefined"!=typeof e.janrainCapture.backplane_bus_name&&(Backplane(Drupal.janrainCapture.bp_ready),Backplane.init({serverBaseURL:e.janrainCapture.backplane_server,busName:e.janrainCapture.backplane_bus_name}))}}window.CAPTURE=Drupal.janrainCapture}},Drupal.janrainCapture.resize=function(n){var e=a.parseJSON(n);a("#fancybox-inner, #fancybox-wrap, #fancybox-content, #fancybox-frame").css({width:e.w,height:e.h}),a.fancybox.resize(),a.fancybox.center()},Drupal.janrainCapture.passwordRecover=function(n){a.fancybox({type:"iframe",href:n,padding:0,scrolling:"no",autoScale:!0,width:666,autoDimensions:!1})},Drupal.behaviors.janrainCaptureUi={attach:function(n,e){a.fn.fancybox&&a(".janrain_capture_anchor",n).once("capture-ui",function(){var n=a(this).data();a(this).addClass("iframe").fancybox({padding:0,scrolling:"no",autoScale:!0,width:666,autoDimensions:!1,onStart:function(){n.destination&&Drupal.janrainCapture.addDestination(n.destination)},onClosed:function(){n.destination&&Drupal.janrainCapture.removeDestination(n.destination)}})})}}}(jQuery);